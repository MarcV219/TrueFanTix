"use client"; import React from "react"; import Link from "next/link"; import Image from "next/image"; import { useRouter } from "next/navigation"; import Footer from "@/components/Footer"; type ApiTicket = { id: string; title: string; date: string; venue: string; row: string | null; seat: string | null; // from your API price: number; // dollars (computed from cents) faceValue: number | null; // dollars (computed from cents) status: "AVAILABLE" | "SOLD"; image: string; sellerId: string; seller: null | { id: string; name: string; rating: number; reviews: number; creditBalance: number; badges: string[]; }; // Optional future shape (prevents TS errors if API includes it) event?: { selloutStatus?: "SOLD_OUT" | "NOT_SOLD_OUT" | string; } | null; }; type TicketCard = { id: string; title: string; date: string; venue: string; row: string | null; seat: string | null; price: number; image: string; sellerId: string; badges: string[]; rating: number; reviews: number; priceTag: "Face Value" | "Below Face Value"; eventType: string; eventTypeLabel: string; isSoldOut: boolean; placeholderImage: string; dynamicImage?: string; }; // Forum API shapes (based on your /api/forum/threads GET) type ApiForumThread = { id: string; title: string; topicType: "ARTIST" | "TEAM" | "SHOW" | "OTHER"; topic: string | null; createdAt: string; updatedAt: string; _count?: { posts?: number }; }; type ForumThreadPreview = { id: string; title: string; topicType: ApiForumThread["topicType"]; topic: string | null; updatedAt: string | null; replies: number; }; const badgeTooltips: Record<string, string> = { VIP: "VIP Access", Verified: "Verified Seller", "Early Access": "Early Access Ticket", }; const DEFAULT_IMAGE = "/default.jpg"; function resolveTicketImageSrc(raw: unknown) { let s = String(raw ?? "").trim(); if (!s) return DEFAULT_IMAGE; const winPublicIdx = s.toLowerCase().lastIndexOf("\\public\\"); if (winPublicIdx !== -1) { s = s.slice(winPublicIdx + "\\public\\".length).replaceAll("\\", "/"); } if (s.toLowerCase().startsWith("public/")) s = s.slice("public/".length); if (s.toLowerCase().startsWith("/public/")) s = s.slice("/public/".length); if (s === "/img" s.startsWith("/img?") s.startsWith("/img/")) return DEFAULT_IMAGE; if (s === "img" s.startsWith("img?") s.startsWith("img/")) return DEFAULT_IMAGE; if (s === "/seed-image" s.startsWith("/seed-image?") s.startsWith("/seed-image/")) return DEFAULT_IMAGE; if (s === "seed-image" s.startsWith("seed-image?") s.startsWith("seed-image/")) return DEFAULT_IMAGE;